{{- $cols := .Get "cols" | default 4 -}}
<style>
  /* ====== 网格：每行 {{ $cols }} 列，保持你的断点 ====== */
  .gallery-grid{
    display:grid;
    grid-template-columns:repeat({{ $cols }},minmax(0,1fr));
    gap:12px;
  }
  @media (max-width:1024px){ .gallery-grid{ grid-template-columns:repeat(3,minmax(0,1fr)); } }
  @media (max-width:768px){  .gallery-grid{ grid-template-columns:repeat(2,minmax(0,1fr)); } }
  @media (max-width:480px){  .gallery-grid{ grid-template-columns:repeat(1,minmax(0,1fr)); } }

  /* ====== 单元格：固定正方形 + 圆角 + 居中承载 ====== */
  .gallery-grid .gallery-item{
    position:relative;
    aspect-ratio:1/1;           /* 固定正方形容器 */
    border-radius:10px;
    overflow:hidden;            /* 保留圆角；不影响 contain 的留白可见 */
    display:flex;               /* 用 flex 居中图片 */
    align-items:center;         /* 垂直居中 */
    justify-content:center;     /* 水平居中 */
    background:rgba(0,0,0,.2);  /* 留白底色 */
    text-decoration:none;
  }

  /* ====== 关键：图片不裁切，始终四向居中 ====== */
  .gallery-grid .gallery-item > img{
    width:100% !important;      /* 让图片“占满容器盒” */
    height:100% !important;     /* 高度也占满，交给 object-fit 控制比例 */
    max-width:none !important;  /* 防止外部 max-* 干扰缩放 */
    max-height:none !important;
    object-fit:contain !important;      /* 横图等宽、竖图等高、无裁切 */
    object-position:center center !important; /* 居中对齐（左右/上下都居中） */
    display:block;
  }
</style>

<div class="gallery-grid">
  {{- range .Page.Resources.ByType "image" -}}
    <a class="gallery-item" href="{{ .RelPermalink }}" target="_blank" title="{{ .Name }}">
      <img src="{{ .RelPermalink }}" alt="{{ .Name }}" loading="lazy">
    </a>
  {{- end -}}
</div>
